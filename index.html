<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Cuentas Netflix</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>Gestión de Cuentas Netflix</h1>
    
    <h2>Agregar Cuenta Completa</h2>
    <form id="addAccountForm">
        <label for="email">Correo:</label>
        <input type="email" id="email" required>
        
        <label for="password">Contraseña:</label>
        <input type="password" id="password" required>
        
        <label for="cliente">Número del Cliente:</label>
        <input type="text" id="cliente" required>
        
        <label for="fechaCorte">Fecha de Corte:</label>
        <input type="date" id="fechaCorte" required>
        
        <label for="pago">Pagado:</label>
        <input type="checkbox" id="pago">
        
        <button type="submit">Agregar Cuenta</button>
    </form>
    
    <h2>Filtrar Cuentas</h2>
    <input type="text" id="filterInput" placeholder="Filtrar por correo...">
    
    <h2>Lista de Cuentas</h2>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Correo</th>
                <th>Cliente</th>
                <th>Fecha de Corte</th>
                <th>Pagado</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody id="accountList"></tbody>
    </table>
    
    <script>
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm';

        const supabaseUrl = 'https://vdsdtouiokgvzrscaroe.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZkc2R0b3Vpb2tndnpyc2Nhcm9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDEyMTU1NjQsImV4cCI6MjA1Njc5MTU2NH0.zZ_PsL3vXmNNaaWWu9yHGdYn7vfYhzH4jpAwyG9tJqA';
        const supabase = createClient(supabaseUrl, supabaseKey);

        async function fetchAccounts() {
            const { data, error } = await supabase.from('netflix').select('*');
            if (error) console.error(error);
            else renderAccounts(data);
        }

        function renderAccounts(accounts) {
            const tableBody = document.getElementById('accountList');
            tableBody.innerHTML = '';
            accounts.forEach(account => {
                const row = `<tr>
                    <td>${account.id}</td>
                    <td contenteditable="true" data-id="${account.id}" class="editable">${account.email}</td>
                    <td>${account.cliente}</td>
                    <td>${account.fecha_corte}</td>
                    <td>${account.pago ? 'Sí' : 'No'}</td>
                    <td><button onclick="deleteAccount(${account.id})">Eliminar</button></td>
                </tr>`;
                tableBody.innerHTML += row;
            });
        }

        async function addAccount(event) {
            event.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const cliente = document.getElementById('cliente').value;
            const fechaCorte = document.getElementById('fechaCorte').value;
            const pago = document.getElementById('pago').checked;
            await supabase.from('netflix').insert([{ email, password, cliente, fecha_corte: fechaCorte, pago }]);
            fetchAccounts();
        }

        async function deleteAccount(id) {
            await supabase.from('netflix').delete().eq('id', id);
            fetchAccounts();
        }

        document.getElementById('addAccountForm').addEventListener('submit', addAccount);
        document.getElementById('filterInput').addEventListener('input', (event) => {
            const filter = event.target.value.toLowerCase();
            document.querySelectorAll('#accountList tr').forEach(row => {
                row.style.display = row.cells[1].textContent.toLowerCase().includes(filter) ? '' : 'none';
            });
        });

        document.addEventListener('DOMContentLoaded', fetchAccounts);
    </script>
</body>
</html>
